<!DOCTYPE html>
<html lang="ar">
<head>
    <link rel="stylesheet" href="style.css">
<meta charset="UTF-8">
<title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø©</title>
</head>

<body>

<button class="back" onclick="goTo('index.html')">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>

<h2>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªÙˆÙ‰</h2>
<div id="difficulty">
    <button onclick="setLevel('easy')">Ø³Ù‡Ù„</button>
    <button onclick="setLevel('hard')">ØµØ¹Ø¨</button>
</div>

<div id="timer"></div>
<div id="board"></div>

<div id="actions" style="display:none">
    <button class="back" onclick="location.reload()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</button>
</div>

<script src="script.js"></script>

<script>
let level="";
let cards=[];
let first=null, second=null, lock=false;
let matches=0, totalPairs=0;
let startTime, timerInt;

function setLevel(l){
    level=l;
    const count = l==="easy"?16:30;
    totalPairs = count/2;
    cards = shuffle([...Array(totalPairs).keys()].map(i=>i+1).flatMap(n=>[n,n]));
    difficulty.style.display="none";
    startGame();
}

function shuffle(a){return a.sort(()=>Math.random()-0.5)}

function startGame(){
    matches=0;
    first=second=null;
    lock=false;
    board.innerHTML="";

    const cols = level==="easy"?4:6;
    board.style.gridTemplateColumns=`repeat(${cols},80px)`;

    cards.forEach(n=>{
        const c=document.createElement("div");
        c.className="card hidden";
        c.dataset.num=n;
        c.onclick=()=>flip(c);
        board.appendChild(c);
    });

    startTime=Date.now();
    timerInt=setInterval(updateTimer,1000);
}

function updateTimer(){
    const t=Math.floor((Date.now()-startTime)/1000);
    timer.innerText="â±ï¸ Ø§Ù„ÙˆÙ‚Øª: "+t+" Ø«Ø§Ù†ÙŠØ©";
}

function flip(card){
    if(lock || !card.classList.contains("hidden"))return;
    card.classList.remove("hidden");
    card.innerText=card.dataset.num;

    if(!first){ first=card; return; }
    second=card;
    lock=true;

    setTimeout(checkMatch,600);
}

function checkMatch(){
    if(first.dataset.num===second.dataset.num){
        matches++;
        if(matches===totalPairs) endGame();
    }else{
        first.classList.add("hidden");
        second.classList.add("hidden");
        first.innerText=second.innerText="";
    }
    first=second=null;
    lock=false;
}

function endGame(){
    clearInterval(timerInt);
    const time=Math.floor((Date.now()-startTime)/1000);

    let msg="";
    if(time<=40) msg="Ø­ÙŠÙ‘ Ø¹ÙŠÙ†Ùƒ ğŸ”¥";
    else if(time<=60) msg="Ù…Ø§Ø§Ø§Ø§Ø´ ğŸ˜…";
    else msg="Ø·ÙˆÙ‘Ù„Øª ÙŠØ§ Ø£Ø®ÙŠ Ø¬Ø§Ù†Ø§ Ø§Ù„Ù†ÙˆÙ… ğŸ˜´";

    showCenterMessage(msg + "\nÙˆÙ‚ØªÙƒ: " + time + " Ø«Ø§Ù†ÙŠØ©");

    saveScore({
        game:"memory",
        score:time,
        text:"ğŸƒ Ø°Ø§ÙƒØ±Ø©: "+time+" Ø«Ø§Ù†ÙŠØ©"
    });

    setTimeout(()=>{
        actions.style.display="block";
    },3000);
}
</script>

</body>
</html>
